<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>手写Promise</title>
</head>

<body>
  <script>
    const PENDING = 'PENDING'
    const FULFILLED = 'FULFILLED'
    const REJECTED = 'REJECTED'
    class MyPromise {
      constructor(fn) {
        this.state = PENDING
        this.value = null
        this.resolveCallbacks = []
        this.rejectCallbacks = []
        fn(resolve, reject)
      }
      then(resolve) {
        setTimeout(() => {
          resolve()
        }, 1000);
      }
      catch () {}
      finnally() {}
    }
  </script>
  <script>
    // 步骤1
    const promise = new MyPromise((resolve, reject) => {
      setTimeout(() => {
        // ajax 获取数据
        resolve("step1");
      }, 1000);
    }).then(data => {
      console.log("获取到数据：", data);
    });

    // 步骤2
    //   const promise = new MyPromise((resolve, reject) => {
    //     resolve("step2");
    //   }).then(data => {
    //     console.log("获取到数据：", data);
    //   });

    // 步骤3
    //   const promise = new MyPromise((resolve, reject) => {
    //     resolve("step3");
    //     resolve("step3.1");
    //   }).then(data => {
    //     console.log("获取到数据：", data);
    //   });

    // 步骤4
    //   const promise = new MyPromise((resolve, reject) => {
    //     resolve("step4");
    //   })
    //     .then(data => {
    //       console.log("获取到数据：", data);
    //       return "step4.1";
    //     })
    //     .then(data => {
    //       console.log("获取到数据：", data);
    //     });

    // 步骤5
    //   const promise = new MyPromise((resolve, reject) => {
    //     resolve("step5");
    //   })
    //     .then(data => {
    //       console.log("获取到数据：", data);
    //       return "step5.1";
    //     })
    //     .then()
    //     .then(data => {
    //       console.log("获取到数据：", data);
    //     });

    // 步骤6
    //   const promise = new MyPromise((resolve, reject) => {
    //     resolve("step6");
    //   })
    //     .then(data => {
    //       console.log("获取到数据：", data);
    //       return {
    //         then(r, j) {
    //           r("step6.1");
    //         }
    //       };
    //     })
    //     .then(data => {
    //       console.log("获取到数据：", data);
    //     });

    // 步骤7
    //   const promise = new MyPromise((resolve, reject) => {
    //     resolve("step7");
    //   })
    //     .then(data => {
    //       console.log("获取到数据：", data);
    //       return new MyPromise(resolve => {
    //         resolve("7.1");
    //       });
    //     })
    //     .then(data => {
    //       console.log("获取到数据：", data);
    //     });

    // 步骤8
    //   const promise = new MyPromise((resolve, reject) => {
    //     resolve(
    //       new Promise(resolve => {
    //         resolve("step8");
    //       })
    //     );
    //   }).then(data => {
    //     console.log("获取到数据：", data);
    //   });

    // step9
    //   const promise = new MyPromise((resolve, reject) => {
    //     resolve("step9");
    //   });
    //   const promise1 = promise.then(data => {
    //     return promise1;
    //   });

    // step10
    //   MyPromise.all([
    //     new MyPromise(resolve => {
    //       resolve(1);
    //     }),
    //     new MyPromise(resolve => {
    //       resolve(2);
    //     })
    //   ]).then(dataList => {
    //     console.log(dataList);
    //   });

    // step11
    //   const promise = new MyPromise((resolve, reject) => {
    //     reject("step11");
    //   }).then(
    //     data => {
    //       console.log("resolve 值：", data);
    //     },
    //     rej => {
    //       console.log("reject 值：", rej);
    //     }
    //   );

    // step12
    // const promise = new MyPromise((resolve, reject) => {
    //   resolve("step12");
    // });

    // setTimeout(() => {
    //   promise.then(data => {
    //     console.log("step12:", data);
    //   });

    //   promise.then(data => {
    //     console.log("step12:", data);
    //   });
    // }, 1000);
  </script>
</body>

</html>